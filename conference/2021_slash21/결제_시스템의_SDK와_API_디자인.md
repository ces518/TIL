# 결제 시스템의 SDK 와 API 디자인

## PG 사 연동시 개발사 경험 개선
- 기존 레거시는 특정 모듈 및 언어 종속적인 구조 / 이해하기 힘든 파라미터 명 등이 문제
- 특정 모듈 종속적인 것이 아닌 HTTP API로 제공하도록 개선
- 기존에 연동된 가맹정을 대상으로 모두 변경하기란 쉽지 않음
- 신규 연동하는 가맹점을 대상으로 순차적으로 제공

## API 디자인
- 고려사항
    - 가맹점 편의 우선
    - 쉽고 간결한 디자인
    - 웹 표준 사용

`가맹점 편의 우선`
- 인프라에서 막히는 경우도 많음
- 레거시 모듈에서 지원하지 않는 경우
- GET, POST 를 제외한 다른 메소드에 익숙하지 않는 경우
> 생각보다 많은 가맹점이 DELETE, PUT 을 사용하지 않는 경우가 많았다.

- GET / POST 만을 사용해 제공함
    - 상태를 변경하는경우 POST / 그렇지 않은 경우 GET 을 사용
    - API 가 충돌될 수 있는데 이런 경우 동사형 단어를 사용했음 
> 예측 가능한 일관성을 정의

`쉽고 간결한 디자인`
- API 구성요소를 3가지로 나눠 디자인
    - PATH
      - 일관성 있는 PATH 구조
    - REQUEST / RESPONSE
      - 인지하기 쉬운 요청과 응답
      - Json 을 이용해 Nested Object 활용
      - 반복될수 있는 필드를 하나로 그루핑
      - 하나의 API 와 관련된 객체들을 최대한 재사용
        - 결제 승인 / 조회 / 취소의 경우 객체가 동일
        - 개발 생산성도 올라가며 / 사용자 편의성도 높임
      - Accept-Language 헤더를 이용해 국제화 대응
      - HTTP Status Code 를 활용해서 처리 결과를 표현

`웹 표준만을 사용`
- HTTPS/ SSL -> TLS1.2 이상
- 베이직 인증/ 베어러 토큰 인증을 표준으로 제공 -> Authorization 헤더를 활용

