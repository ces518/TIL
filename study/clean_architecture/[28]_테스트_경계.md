## 28장 테스트 경계

## 3색 볼펜 스터디
- 빨강 : 매우 중요하다 생각하는 부분
- 파랑 : 중요하다 생각하는 부분
- 초록 : 흥미로운 부분

## 시스템 컴포넌트인 테스트
- 테스트는 시스템의 일부일까 ? 별개일까 ?
- 어떤 종류의 테스트가 있을까 ?
- 아키텍처 관점에서 모든 테스트는 동일하다
- 테스트는 태생적으로 의존성 규칙을 따른다
  - 세부적이며 규체적인 것으로, 의존성은 항상 테스트 대상이 되는 코드를 향한다
  - 실제 테스트는 아키텍처에서 가장 바깥쪽 원으로 생각할 수 있다
  - 시스템 내부의 어떠한 것도 테스트에 의존하지 않으며 테스트는 항상 원의 안쪽으로 의존한다
- 테스트는 독립적 배포가 가능하다
  - 대다수의 경우 테스트는 테스트 시스템에만 배포하며 상용 시스템에는 배포하지 않는다
  - 배포 독립성이 필요하지 않은 시스템에서도 테스트는 독립적으로 배포 된다
- 테스트는 시스템 컴포넌트 중 가장 고립되어 있다
  - 테스트가 시스템 운영에 꼭 필요하진 않다
  - 어떤 사용자도 테스트에 의존하지 않으며 테스트는 개발을 지원하는 역할이다
  - 테스트가 시스템 컴포넌트가 아니라는 뜻이 아니며 다른 모든 시스템 컴포넌트가 반드시 지켜야할 모델을 표현해 준다

## 테스트를 고려한 설계
- 테스트가 시스템의 설계와 잘 통합되지 않으면, 깨지기 쉽고 시스템은 뻣뻣해져 변경하기 어려워진다
- 깨지기 쉬운 테스트는 시스템을 뻣뻣하게 만든다는 부작용을 낳을 때가 많다
- 간단한 변경으로 인해 대량의 테스트 실패로 이어진다면 개발자는 변경을 하지않으로 할 것이다
- 이 문제를 해결하려면 테스트를고려해 설계해야 한다
- 소프트웨어 설계의 첫 규칙은 언제나 같다
  - 변동성이 있는 것에 의존하지 말라
  - GUI 라면 GUI 에 의존해서는 안된다

## 테스트 API
- 목표를 달성하려면 테스트가 모든 업무 규칙을 검증하는 데 사용할 수 있도록 특화된 API 를 만들어야 한다
- 값비산 자원은 건너뛰고, 시스템을 테스트 가능한 특정 상태로 강제하는 강력한 힘을 가져야 한다
- 이는 사용자 인터페이스가 사용하는 인터렉터와 인터페이스 어댑터 들의 상위 집합이 될 것이다
- 테스트 API 는 테스트를 애플리케이션으로 부터 분리할 목적으로 상요한다
- 단순 UI 와의 분리가 아닌 테스트 구조를 애플리케이션 구조로 부터 분리하는 것이 목표

### 구조적 결합
- 테스트 API 의 역할 -> 애플리케이션의 구조를 테스트로 부터 숨기는 것
- 상용 코드를 리팩터링 하거나 진화시키더라도 테스트에는 전혀 영향을 주지 않는다
- 테스트 리팩터링 / 진화할때에도 상용코드에 전혀 영향을 주지 않는다
- 이처럼 따로 진화가 가능하다는 것은 서로 특화된 형태로 변화가 가능하다는 것이다

### 보안
- 테스트 API 가 지닌 강력한 힘을 운영 시스템에 배포하면 위험하기 때문에
- 테스트 API 와 테스트 API 중 위험한 부분을 독립적으로 배포가능한 컴포넌트로 분리해야 한다

## 결론
- 테스트는 시스템의 일부이다
- 테스트에서 기대하는 안정성과 회귀의 이점을 얻을 수 있을면 테스트는 잘 설계돼야만 한다
- 테스트를 시스템의 일부로 설계하지 않으면 깨지기 쉽고 유지보수 하기 어려워 진다
